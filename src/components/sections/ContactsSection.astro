---
import { SOCIALS } from "src/consts";
import {
  Github,
  Linkedin,
  Instagram,
  Mail,
  Twitter,
  Youtube,
} from "lucide-astro";

// Filter social media yang ingin ditampilkan di contact section
const contactSocials = SOCIALS.filter((social) =>
  ["GitHub", "LinkedIn", "Instagram", "Twitter", "YouTube", "Email"].includes(
    social.NAME
  )
);
---

<section
  class="flex items-center justify-center pt-2 pb-2 px-2"
  aria-labelledby="contacts-heading">
  <div
    class="w-full max-w-5xl bg-white dark:bg-gray-800 rounded-2xl shadow-lg grid grid-cols-1 md:grid-cols-2 overflow-hidden">
    <!-- Left: Contact Info -->
    <div class="bg-gray-900 text-white p-6 flex flex-col justify-between">
      <div>
        <h3 class="text-2xl font-semibold mb-2">Contact information</h3>
        <p class="text-gray-300 mb-6">
          If you have any questions, feel free to get in touch with us.
        </p>
        <ul class="space-y-4 mb-8">
          <li class="flex items-center gap-3">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-gray-800 rounded-full">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
                ><path
                  d="M22 16.92V19a2 2 0 0 1-2.18 2A19.72 19.72 0 0 1 3 5.18 2 2 0 0 1 5 3h2.09a2 2 0 0 1 2 1.72c.13 1.05.37 2.07.72 3.06a2 2 0 0 1-.45 2.11l-.27.27a16 16 0 0 0 6.29 6.29l.27-.27a2 2 0 0 1 2.11-.45c.99.35 2.01.59 3.06.72A2 2 0 0 1 22 16.92z"
                ></path></svg
              >
            </span>
            <span>773 097 6543</span>
          </li>
          <li class="flex items-center gap-3">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-gray-800 rounded-full">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
                ><path d="M4 4h16v16H4z" fill="none"></path><path
                  d="M22 6l-10 7L2 6"></path></svg
              >
            </span>
            <span>assistant@oneinvestmentholding.com</span>
          </li>
          <li class="flex items-center gap-3">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-gray-800 rounded-full">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
                ><path
                  d="M17.657 16.657L13.414 12.414a2 2 0 0 0-2.828 0l-4.243 4.243A8 8 0 1 1 21 12a7.963 7.963 0 0 1-3.343 4.657z"
                ></path><circle cx="12" cy="12" r="3"></circle></svg
              >
            </span>
            <span>202 Christina Dr, East Dundee, IL 60118</span>
          </li>
        </ul>
        <div class="mb-8">
          <div class="flex items-center gap-3 mb-1">
            <span
              class="inline-flex items-center justify-center w-8 h-8 bg-gray-800 rounded-full">
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24"
                ><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"
                ></path></svg
              >
            </span>
            <span>Monday-Friday</span>
          </div>
          <div class="ml-11 text-white font-semibold">9:00 AM - 6:00 PM</div>
        </div>
      </div>
      <div class="flex gap-4 mt-8">
        {
          contactSocials.map((social) => (
            <a
              href={social.HREF}
              class="hover:text-gray-400"
              aria-label={social.NAME}
              target="_blank"
              rel="noopener noreferrer">
              {social.NAME === "GitHub" && <Github class="w-6 h-6" />}
              {social.NAME === "LinkedIn" && <Linkedin class="w-6 h-6" />}
              {social.NAME === "Instagram" && <Instagram class="w-6 h-6" />}
              {social.NAME === "Twitter" && <Twitter class="w-6 h-6" />}
              {social.NAME === "YouTube" && <Youtube class="w-6 h-6" />}
              {social.NAME === "Email" && <Mail class="w-6 h-6" />}
            </a>
          ))
        }
      </div>
    </div>
    <!-- Right: Contact Form -->
    <div class="p-6 bg-white dark:bg-gray-800 flex flex-col justify-center">
      <form class="space-y-5" id="contactForm">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label
              class="block text-gray-700 dark:text-gray-300 mb-1 font-medium"
              for="firstName">First name</label
            >
            <input
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white text-black placeholder-gray-400"
              type="text"
              id="firstName"
              name="firstName"
              placeholder="First name"
              required
            />
            <div class="error-message hidden text-red-500 text-sm mt-1"></div>
          </div>
          <div>
            <label
              class="block text-gray-700 dark:text-gray-300 mb-1 font-medium"
              for="lastName">Last name</label
            >
            <input
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white text-black placeholder-gray-400"
              type="text"
              id="lastName"
              name="lastName"
              placeholder="Last name"
              required
            />
            <div class="error-message hidden text-red-500 text-sm mt-1"></div>
          </div>
        </div>
        <div>
          <label
            class="block text-gray-700 dark:text-gray-300 mb-1 font-medium"
            for="email">Email</label
          >
          <input
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white text-black placeholder-gray-400"
            type="email"
            id="email"
            name="email"
            placeholder="email@example.com"
            required
          />
          <div class="error-message hidden text-red-500 text-sm mt-1"></div>
        </div>
        <div>
          <label
            class="block text-gray-700 dark:text-gray-300 mb-1 font-medium"
            for="phone">Phone number</label
          >
          <input
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white text-black placeholder-gray-400"
            type="tel"
            id="phone"
            name="phone"
            placeholder="+1 (555) 000-0000"
          />
          <div class="error-message hidden text-red-500 text-sm mt-1"></div>
        </div>
        <div>
          <label
            class="block text-gray-700 dark:text-gray-300 mb-1 font-medium"
            for="message">Message</label
          >
          <textarea
            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white text-black placeholder-gray-400 resize-none"
            id="message"
            name="message"
            rows="4"
            placeholder="Your message"
            required></textarea>
          <div class="error-message hidden text-red-500 text-sm mt-1"></div>
        </div>
        <div class="flex justify-end">
          <button
            type="submit"
            class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 flex items-center gap-2">
            <span class="animate-spin hidden">
              <svg
                class="w-4 h-4"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                viewBox="0 0 24 24">
                <path
                  d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"
                ></path>
              </svg>
            </span>
            Send message
          </button>
        </div>
      </form>
    </div>
  </div>
</section>

<script>
  // Form handling
  const form = document.getElementById("contactForm") as HTMLFormElement;
  const submitButton = form?.querySelector(
    'button[type="submit"]'
  ) as HTMLButtonElement;
  const loader = submitButton?.querySelector(".animate-spin");

  if (form && submitButton && loader) {
    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      // Reset previous errors
      form.querySelectorAll(".error-message").forEach((el) => {
        el.classList.add("hidden");
        el.textContent = "";
      });

      // Validate form
      const formData = new FormData(form);
      let isValid = true;

      for (const [key, value] of formData.entries()) {
        const input = form.querySelector(`[name="${key}"]`) as HTMLInputElement;
        const errorElement = input?.nextElementSibling as HTMLElement;

        if (!input || !errorElement) continue;

        if (!input.checkValidity()) {
          isValid = false;
          errorElement.textContent = input.validationMessage;
          errorElement.classList.remove("hidden");
        }
      }

      if (!isValid) return;

      // Show loading state
      submitButton.disabled = true;
      loader.classList.remove("hidden");

      try {
        // Simulate form submission (replace with actual API call)
        await new Promise((resolve) => setTimeout(resolve, 1500));

        // Reset form
        form.reset();
        alert("Message sent successfully!");
      } catch (error) {
        alert("Failed to send message. Please try again.");
      } finally {
        // Reset loading state
        submitButton.disabled = false;
        loader.classList.add("hidden");
      }
    });
  }
</script>
