---
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ui/ArrowCard";
import { SITE, PROJECTS, BLOG } from "src/consts";
import { getLatestPosts, getLatestProjects } from "@/lib/data";

// Page Sections
import BackgroundEffects from "@components/effects/BackgroundEffects.astro";
import HeroSection from "@components/sections/HeroSection.astro";
import AboutSection from "@components/sections/AboutSection.astro";
import SkillsSection from "@components/sections/SkillsSection.astro";
import ExperienceSection from "@components/sections/ExperienceSection.astro";
import AchievementsSection from "@components/sections/AchievementsSection.astro";

const [posts, projects] = await Promise.all([
  getLatestPosts(3),
  getLatestProjects(3),
]);
---

<PageLayout title="Home" description={SITE.DESCRIPTION}>
  <BackgroundEffects />
  <HeroSection />
  <main class="relative bg-white dark:bg-black">
    <div class="mx-auto max-w-6xl px-5 py-16 space-y-24">
      <AboutSection />
      <SkillsSection />
      <ExperienceSection />
      <AchievementsSection />

      <!-- Featured Projects -->
      <section class="animate" aria-labelledby="projects-heading">
        <header
          class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8 gap-4">
          <h2
            id="projects-heading"
            class="text-2xl md:text-3xl font-bold text-black dark:text-white">
            {PROJECTS.TITLE}
          </h2>
          <a
            href="/projects"
            class="nav-link group"
            aria-label="View all projects">
            <span>View All Projects</span>
            <svg
              class="w-4 h-4 group-hover:translate-x-1 transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </header>

        {
          projects.length > 0 ?
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {projects.slice(0, 3).map((project) => (
                <article class="project-card">
                  <ArrowCard entry={project} />
                </article>
              ))}
            </div>
          : <div class="text-center py-12">
              <p class="text-gray-600 dark:text-gray-400">
                No projects available at the moment.
              </p>
            </div>
        }
      </section>

      <!-- Latest Articles -->
      {
        posts.length > 0 && (
          <section class="animate" aria-labelledby="blog-heading">
            <header class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-8 gap-4">
              <h2
                id="blog-heading"
                class="text-2xl md:text-3xl font-bold text-black dark:text-white">
                {BLOG.TITLE}
              </h2>
              <a
                href="/blog"
                class="nav-link group"
                aria-label="Read more articles">
                <span>Read More</span>
                <svg
                  class="w-4 h-4 group-hover:translate-x-1 transition-transform duration-200"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 8l4 4m0 0l-4 4m4-4H3"
                  />
                </svg>
              </a>
            </header>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {posts.slice(0, 3).map((post) => (
                <article>
                  <ArrowCard entry={post} />
                </article>
              ))}
            </div>
          </section>
        )
      }
    </div>
  </main>
</PageLayout>
